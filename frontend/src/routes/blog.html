<template>
    <require from="converters/markdown-format"></require>
    <require from="converters/trim-html-converter"></require>
    <section>
        <div class="post" show.bind="query != undefined">
            Search Results for "${query}"
        </div>
        <div class="post" repeat.for="post of posts">
            <a class="titleLink" route-href="route: post; params.bind: { id: post._id }">
                <div class="titleBox"  css='background-image: url("${post.heroPhotoUrl}")'>
                    <div class="title">${post.title}</div>
                </div>
            </a>
            <p class="grey">by ${post.author}, ${secondsToDate(post.date)}</p>
            <p>
                <div innerhtml.bind="post.content | markdownFormat | trimHtml : previewLength"></div>
            </p>
            <div class="grey small"><a route-href="route: post; params.bind: { id: post._id }">${post.comments.length} comment${post.comments.length == 1 ? "" : "s"}</a></div>
        </div>
        <div class="post" show.bind="posts.length == 0">
            Couldn't find any posts. Sorry :(
        </div>
        <div show.bind="!isSearchPage()">
            <div show.bind="start != 0">
                <a class="nextPrevPageLink" route-href="route: blog; params.bind: { start: (start-num<0)?0:start-num }">newer posts</a>
            </div>
            <div show.bind="remainingPosts > 0">
                <a class="nextPrevPageLink" route-href="route: blog; params.bind: { start: start+num }">older posts</a>
            </div>
        </div>
        <div show.bind="isSearchPage()">
            <div show.bind="start != 0">
                <a class="nextPrevPageLink" route-href="route: search; params.bind: {query: query, start: (start-num<0)?0:start-num }">previous results</a>
            </div>
            <div show.bind="remainingPosts > 0">
                <a class="nextPrevPageLink" route-href="route: search; params.bind: {query: query, start: start+num }">more results</a>
            </div>
        </div>
    </section>
</template>